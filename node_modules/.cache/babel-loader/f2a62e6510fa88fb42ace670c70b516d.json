{"ast":null,"code":"import _defineProperty from\"/home/ashutosh/Desktop/pyve/myenv/react-notemaster-master/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/home/ashutosh/Desktop/pyve/myenv/react-notemaster-master/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/home/ashutosh/Desktop/pyve/myenv/react-notemaster-master/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/home/ashutosh/Desktop/pyve/myenv/react-notemaster-master/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/ashutosh/Desktop/pyve/myenv/react-notemaster-master/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/ashutosh/Desktop/pyve/myenv/react-notemaster-master/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/ashutosh/Desktop/pyve/myenv/react-notemaster-master/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/ashutosh/Desktop/pyve/myenv/react-notemaster-master/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Fragment}from'react';import'./Dashboard.css';import SidebarComponent from'../sidebar/sidebar';import EditorComponent from'../editor/editor';import{connect}from'react-redux';import axios from'axios';import clsx from'clsx';import Drawer from'@material-ui/core/Drawer';import CssBaseline from'@material-ui/core/CssBaseline';import AppBar from'@material-ui/core/AppBar';import Toolbar from'@material-ui/core/Toolbar';import Typography from'@material-ui/core/Typography';import IconButton from'@material-ui/core/IconButton';import MenuIcon from'@material-ui/icons/Menu';import ChevronLeftIcon from'@material-ui/icons/ChevronLeft';import ChevronRightIcon from'@material-ui/icons/ChevronRight';import styles from'./dashboardStyles';import{withStyles}from'@material-ui/core/styles';import ExitToAppIcon from'@material-ui/icons/ExitToApp';import*as actions from'../store/actions/auth';import Tooltip from'@material-ui/core/Tooltip';import{withRouter}from'react-router-dom';var DashboardComponent=/*#__PURE__*/function(_React$Component){_inherits(DashboardComponent,_React$Component);function DashboardComponent(){var _this;_classCallCheck(this,DashboardComponent);_this=_possibleConstructorReturn(this,_getPrototypeOf(DashboardComponent).call(this));_this.getNotesFromDb=function(){axios.get('https://notemaster.herokuapp.com/api/notes/').then(function(res){return _this.setState({notes:res.data});}).catch(function(err){console.log(err);});};_this.selectNote=function(note,index){return _this.setState({selectedNoteIndex:index,selectedNote:note});};_this.noteUpdate=function(id,noteObj){axios.put(\"https://notemaster.herokuapp.com/api/notes/\".concat(id,\"/\"),{title:noteObj.title,body:noteObj.body});_this.getNotesFromDb();};_this.newNote=function _callee(title){var note,newFromDB,newID,newNoteIndex;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:note={title:title,body:''};_context.next=3;return _regeneratorRuntime.awrap(axios.post(\"https://notemaster.herokuapp.com/api/notes/\",{title:note.title,body:note.body}));case 3:newFromDB=_context.sent;newID=newFromDB.data.id;_context.next=7;return _regeneratorRuntime.awrap(_this.setState({notes:[].concat(_toConsumableArray(_this.state.notes),[note])}));case 7:newNoteIndex=_this.state.notes.indexOf(_this.state.notes.filter(function(_note){return _note.id===newID;})[0]);_this.setState({selectedNote:_this.state.notes[newNoteIndex],selectedNoteIndex:newNoteIndex});_this.getNotesFromDb();case 10:case\"end\":return _context.stop();}}});};_this.deleteNote=function _callee2(note){var noteIndex;return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:noteIndex=_this.state.notes.indexOf(note);_context2.next=3;return _regeneratorRuntime.awrap(_this.setState({notes:_this.state.notes.filter(function(_note){return _note!==note;})}));case 3:if(_this.state.selectedNoteIndex===noteIndex){_this.setState({selectedNoteIndex:null,selectedNote:null});}else{_this.state.notes.length>1?_this.selectNote(_this.state.notes[_this.state.selectedNoteIndex-1],_this.state.selectedNoteIndex-1):_this.setState({selectedNoteIndex:null,selectedNote:null});}axios.delete(\"https://notemaster.herokuapp.com/api/notes/\".concat(note.id,\"/\"));case 5:case\"end\":return _context2.stop();}}});};_this.state={selectedNoteIndex:null,selectedNote:null,notes:null,open:false,user:null};return _this;}_createClass(DashboardComponent,[{key:\"componentDidMount\",value:function componentDidMount(){this.props.onTryAutoSignup(this.props.username);console.log(this.state.selectedNote);this.setState({user:localStorage.getItem('user')||this.props.username});var sessionTimeout=localStorage.getItem('token')&&localStorage.getItem('expirationDate');if(!sessionTimeout){this.props.history.push('/login/');}else{this.getNotesFromDb();}}},{key:\"render\",value:function render(){var _this2=this;var token=localStorage.getItem('token');var classes=this.props.classes;var handleDrawerOpen=function handleDrawerOpen(){_this2.setState({open:true});};var handleDrawerClose=function handleDrawerClose(){_this2.setState({open:false});};return React.createElement(Fragment,null,this.props.token||token?React.createElement(\"div\",{className:classes.root},React.createElement(CssBaseline,null),React.createElement(AppBar,{position:\"fixed\",className:clsx(classes.appBar,_defineProperty({},classes.appBarShift,this.state.open))},React.createElement(Toolbar,null,React.createElement(IconButton,{color:\"inherit\",\"aria-label\":\"open drawer\",onClick:handleDrawerOpen,edge:\"start\",className:clsx(classes.menuButton,this.state.open&&classes.hide)},React.createElement(MenuIcon,null)),React.createElement(Typography,{variant:\"h6\",noWrap:true},\"Notemaster\"),React.createElement(Tooltip,{title:\"Log out\"},React.createElement(ExitToAppIcon,{className:\"log-out-icon\",onClick:this.props.logout})))),React.createElement(Drawer,{className:classes.drawer,variant:\"persistent\",anchor:\"left\",open:this.state.open,classes:{paper:classes.drawerPaper}},React.createElement(\"div\",{className:classes.drawerHeader},React.createElement(IconButton,{onClick:handleDrawerClose},classes.direction==='ltr'?React.createElement(ChevronLeftIcon,null):React.createElement(ChevronRightIcon,null))),React.createElement(SidebarComponent,{selectedNoteIndex:this.state.selectedNoteIndex,notes:this.state.notes,deleteNote:this.deleteNote,selectNote:this.selectNote,newNote:this.newNote})),React.createElement(\"main\",{className:clsx(classes.content,_defineProperty({},classes.contentShift,this.state.open))},React.createElement(\"div\",{className:classes.drawerHeader}),this.state.selectedNote?React.createElement(EditorComponent,{selectedNote:this.state.selectedNote,selectedNoteIndex:this.state.selectedNoteIndex,notes:this.state.notes,noteUpdate:this.noteUpdate}):React.createElement(Fragment,null,React.createElement(\"div\",{className:classes.paper},React.createElement(Typography,{className:\"welcome_Header\"},\"Welcome to Notemaster \",React.createElement(\"span\",{className:\"capitalize\"},this.state.user)),React.createElement(Typography,{className:\"welcome\"},\"Notemaster is a web app used to store important notes. \",React.createElement(\"br\",null),\"Just like Google Keep\"),React.createElement(Typography,{className:\"welcome\"},\"Click on the Hamburger Icon on top left to continue\"))))):this.props.history.push('/login/'));}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(newProps,state){newProps.onTryAutoSignup(newProps.username||localStorage.getItem('user'));var token=newProps.token||localStorage.getItem('token');if(token){axios.defaults.headers={\"Content-Type\":\"application/json\",Authorization:\"Token \"+token};}return null;}}]);return DashboardComponent;}(React.Component);var mapStateToProps=function mapStateToProps(state){return{token:state.token,username:state.username};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{logout:function logout(){return dispatch(actions.logout());},onTryAutoSignup:function onTryAutoSignup(username){return dispatch(actions.authCheckState(username));}};};export default withRouter(connect(mapStateToProps,mapDispatchToProps)(withStyles(styles)(DashboardComponent)));","map":null,"metadata":{},"sourceType":"module"}